/* ========================================
   ESTILOS ESPECÍFICOS PARA MODO-ESTUDIO-IA
   ======================================== */

/* Estilos específicos para content-sections - idéntico a left-wrapper */
.content-sections {
    display: flex;
    flex-direction: column;
    gap: 16px;
    flex: 1;
    min-width: 0;
    min-height: 0; /* Permitir que flexbox funcione correctamente */
    width: 100%;
    overflow: visible;
    max-height: none;
    height: 100%; /* Ocupar toda la altura disponible */
}

/* Espaciador para alinear elementos - idéntico a left-wrapper */
.content-sections > *:not(:last-child):not(.section-dual):not(.section-single):not(.section-triple):not(.section-quad) {
    margin-bottom: 16px;
}

/* Espaciador final - idéntico a left-wrapper */
.content-sections::after {
    content: '';
    height: 0px;
    flex-shrink: 0;
    display: none; /* Ocultar para evitar espacio extra */
}

/* Reducir el gap del último elemento - idéntico a left-wrapper */
.content-sections > *:last-child {
    margin-bottom: 0;
}

/* Secciones de widgets */
.section-single {
    display: flex;
    width: 100%;
}

.section-dual {
    display: flex;
    gap: 20px;
}

.section-triple {
    display: flex;
    gap: 20px;
}

.section-quad {
    display: flex;
    gap: 20px;
}

/* Widgets en secciones - sin altura mínima forzada */
.section-single > div,
.section-dual > div,
.section-triple > div,
.section-quad > div {
    background-color: var(--ubits-bg-1);
    border: none;
    border-radius: 8px;
    padding: 12px !important; /* !important para sobrescribir el reset */
    width: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
}

/* Distribución de anchos */
.section-single > div {
    flex: 1;
}

.section-dual > div {
    flex: 1;
}

.section-triple > div {
    flex: 1;
}

.section-quad > div {
    flex: 1;
}

/* Widget header-product: sin fondo blanco ni padding */
.section-single > .widget-header-product {
    background-color: transparent !important;
    padding: 0 !important;
}

/* Modo estudio IA: ocultar título y botón atrás del header (solo mostrar acciones).
   Las acciones se mantienen a la derecha por el componente: .ubits-header-product__actions tiene margin-left: auto. */
.modo-estudio-ia-page .ubits-header-product__product-info {
    display: none !important;
}

/* ========== Modo Tutor IA: layout chat (izq) + panel derecho (Canvas) ========== */
.modo-tutor-ia-chat-section {
    display: flex !important;
    flex-direction: row !important;
    gap: 20px !important;
    flex: 1 1 0 !important;
    min-height: 0 !important;
    overflow: hidden !important;
}

.modo-tutor-ia-chat-main {
    flex: 1 1 0;
    min-width: 0;
    min-height: 0;
    display: flex;
    flex-direction: column;
}

/* Panel derecho (Canvas): oculto por defecto; solo visible al generar recurso (quiz, flashcards, guía, cursos, plan) */
/* Especificidad mayor que .section-single > div para que no lo muestre al cargar */
.modo-tutor-ia-chat-section > .modo-tutor-ia-canvas-panel {
    display: none !important;
    flex-shrink: 0;
}

.modo-tutor-ia-chat-section > .modo-tutor-ia-canvas-panel.is-open {
    display: flex !important;
    flex-direction: column !important;
    flex: 1 1 0;
    min-width: 0;
    width: 50%;
    padding: 0 !important;
    overflow: hidden;
    min-height: 0;
    background: var(--ubits-bg-1) !important;
    border: 1px solid var(--ubits-border-1);
    border-radius: 12px;
    animation: tutor-panel-open 0.2s ease;
}

/* Contenido del canvas: flex para que el footer quede siempre abajo */
.modo-tutor-ia-canvas-panel.is-open .study-chat-canvas-content {
    flex: 1 1 0;
    min-height: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.modo-tutor-ia-canvas-panel.is-open .study-chat-canvas-body {
    flex: 1;
    overflow-y: auto;
    min-height: 0;
}

.modo-tutor-ia-canvas-panel.is-open .study-chat-canvas-footer {
    flex-shrink: 0;
}

@keyframes tutor-panel-open {
    from { opacity: 0; }
    to { opacity: 1; }
}

.modo-tutor-ia-chat-section > .modo-tutor-ia-canvas-panel.is-open .study-chat-canvas-placeholder {
    display: flex;
}

.modo-tutor-ia-chat-section > .modo-tutor-ia-canvas-panel.has-content .study-chat-canvas-placeholder {
    display: none;
}

/* Placeholder del panel (solo visible si el panel está abierto y vacío) */
.study-chat-canvas-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    min-height: 200px;
    text-align: center;
    color: var(--ubits-fg-1-medium);
}

.study-chat-canvas-placeholder i {
    font-size: 32px;
    color: var(--ubits-fg-1-low);
}

/* Widget chat: rellenar el espacio sin añadir caja extra (la sección .modo-tutor-ia-chat-main ya tiene fondo) */
.section-single > .widget-chat,
.modo-tutor-ia-chat-main .widget-chat {
    background-color: transparent !important;
    padding: 0 !important;
    flex: 1 1 0; /* Ocupar todo el espacio disponible */
    min-height: 0; /* Permitir que flexbox funcione */
    display: flex !important;
    flex-direction: column !important;
}

/* Solo los mensajes de la IA sin fondo ni padding (burbujas transparentes y sin relleno) */
.modo-estudio-ia-page .ubits-study-chat__text-globe--ai {
    background: transparent !important;
    padding: 0 !important;
}

/* Asegurar que el contenedor del chat tenga altura completa */
#study-chat-container {
    height: 100% !important;
    min-height: 0 !important;
    display: flex !important;
    flex-direction: column !important;
}


/* Responsive: panel derecho debajo del chat en pantallas medianas/pequeñas */
@media (max-width: 1023px) {
    .modo-tutor-ia-chat-section {
        flex-direction: column !important;
    }
    
    .modo-tutor-ia-chat-section > .modo-tutor-ia-canvas-panel.is-open {
        width: 100%;
        min-width: 0;
        max-width: none;
        max-height: 40vh;
    }
    
    .content-sections {
        padding-bottom: 0;
    }
    
    .section-dual,
    .section-triple,
    .section-quad {
        flex-direction: column;
        gap: 16px;
    }
}

/* Asegurar que también se aplique en responsive */
@media (max-width: 480px) {
    /* Padding reducido en móviles pequeños - sin altura mínima forzada */
    .section-single > div,
    .section-dual > div,
    .section-triple > div,
    .section-quad > div {
        padding: 12px !important; /* !important para sobrescribir el reset */
    }
    
    .section-single > .widget-header-product {
        padding: 0 !important;
    }
    
    .section-single > .widget-chat {
        flex: 1 1 0;
        min-height: 0;
    }
}

/* Asegurar que content-area y content-sections usen flexbox correctamente */
.content-area {
    display: flex !important;
    flex-direction: column !important;
    min-height: 0 !important;
    height: 100% !important;
    padding-bottom: 16px !important; /* Mantener padding inferior para que no esté pegado */
}

.content-sections {
    display: flex !important;
    flex-direction: column !important;
    min-height: 0 !important;
    height: 100% !important;
    padding-bottom: 0 !important; /* Sin padding inferior en sections */
    margin-bottom: 0 !important; /* Sin margin inferior */
}

/* Primera sección (header-product) no debe crecer */
.section-single:first-child {
    flex: 0 0 auto;
}

/* Última sección (chat) debe ocupar todo el espacio restante */
.section-single:last-child {
    flex: 1 1 0; /* Ocupar todo el espacio disponible */
    min-height: 0;
}
