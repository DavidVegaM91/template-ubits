<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="../../images/Ubits-logo-dark.svg">
    <title>UBITS Playground - Cat√°logo</title>
    
    <!-- Estilos locales -->
    <link rel="stylesheet" href="../../general-styles/ubits-colors.css">
    <link rel="stylesheet" href="../../general-styles/styles.css">
    <link rel="stylesheet" href="../../general-styles/fontawesome-icons.css">
    <link rel="stylesheet" href="../../general-styles/ubits-typography.css">
    <link rel="stylesheet" href="../../components/sub-nav.css">
    <link rel="stylesheet" href="../../components/sidebar.css">
    <link rel="stylesheet" href="../../components/tab-bar.css">
    <link rel="stylesheet" href="../../components/floating-menu.css">
    <link rel="stylesheet" href="../../components/profile-menu.css">
    <link rel="stylesheet" href="../../components/input.css">
    <link rel="stylesheet" href="../../components/button.css">
    <link rel="stylesheet" href="../../components/ia-button.css">
    <link rel="stylesheet" href="../../components/carousel-contents.css">
    <link rel="stylesheet" href="../../components/status-tag.css">
    <link rel="stylesheet" href="../../components/tooltip.css">
    <link rel="stylesheet" href="./profile.css">
    <link rel="stylesheet" href="./catalogo-v3.css">
</head>
<body data-theme="light">
    <div class="dashboard-container">
        <div class="tooltip" id="tooltip"></div>
        
        <!-- Sidebar Container -->
        <div id="sidebar-container"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Navigation -->
            <div id="top-nav-container"></div>
            <!-- Content Area -->
            <div class="content-area">
                <!-- Content wrapper con secciones de widgets -->
                <div class="content-sections">
                    <!-- Hero de b√∫squeda -->
                    <div class="catalog-hero">
                        <h1 class="ubits-heading-h1">¬øQu√© quieres aprender hoy?</h1>
                        <div class="catalog-search-wrapper">
                            <div class="catalog-search-container" id="catalog-search-container"></div>
                        </div>
                        <div class="catalog-chips-wrapper">
                            <span class="ubits-body-sm-regular catalog-chips-label">Lo m√°s buscado:</span>
                            <div class="catalog-chips" id="catalog-chips"></div>
                        </div>
                    </div>

                    <!-- Wrapper de secci√≥n de academias -->
                    <div class="academias-section-wrapper">
                        <!-- T√≠tulo de secci√≥n -->
                        <h2 class="ubits-heading-h2 academias-section-title">Explora por academias</h2>

                        <!-- Contenedor de resultados -->
                        <div id="catalog-results"></div>
                    </div>

                    <!-- Wrapper de secci√≥n de aliados destacados - Usando componente oficial -->
                    <div id="aliados-container"></div>
                    
                    <!-- Wrapper de secci√≥n de tipos de contenido (nuevo) -->
                    <div class="tipos-contenido-section-wrapper">
                        <!-- Header con t√≠tulo y controles -->
                        <div class="tipos-contenido-section-header">
                            <h2 class="ubits-heading-h2 tipos-contenido-section-title">Explora por tipo de contenido</h2>
                            <div class="tipos-contenido-controls">
                                <button class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" id="tipos-contenido-nuevo-prev">
                                    <i class="far fa-chevron-left"></i>
                                </button>
                                <button class="ubits-button ubits-button--secondary ubits-button--sm ubits-button--icon-only" id="tipos-contenido-nuevo-next">
                                    <i class="far fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Carrusel de tipos de contenido (nuevo) -->
                        <div class="tipos-contenido-carousel-nuevo" id="tipos-contenido-carousel-nuevo"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Tab Bar Container -->
    <div id="tab-bar-container"></div>

    <!-- Floating Menu Container -->
    <div id="floating-menu-container"></div>
    
    <!-- Profile Menu Container -->
    <div id="profile-menu-container"></div>


        <script src="../../components/tooltip.js"></script>
<script src="../../components/sidebar.js"></script>
    <script src="../../components/sub-nav.js"></script>
    <script src="../../components/tab-bar.js"></script>
    <script src="../../components/floating-menu.js"></script>
    <script src="../../components/profile-menu.js"></script>
    <script src="../../components/input.js"></script>
    <script src="../../components/carousel-contents.js"></script>
    <script src="../../script.js"></script>
    <script>
        // Competencias asignadas al usuario
        const competenciasAsignadas = ['Liderazgo', 'Comunicaci√≥n', 'Ingl√©s'];

        // Datos del CSV parseados
        const catalogData = {
            academias: [
                {
                    nombre: 'Academia de Habilidades Blandas',
                    competencias: [
                        { nombre: 'Accountability', habilidades: ['Autogesti√≥n', 'Proactividad', 'Integridad'] },
                        { nombre: 'Inteligencia emocional', habilidades: ['Empat√≠a', 'Autoconocimiento', 'Autorregulaci√≥n', 'Autocompasi√≥n', 'Resiliencia'] },
                        { nombre: 'Trabajo en equipo', habilidades: ['Trabajo colaborativo', 'Gesti√≥n del conflicto', 'Relacionamiento'] },
                        { nombre: 'Resoluci√≥n de problemas', habilidades: ['An√°lisis de escenarios', 'Toma de decisiones', 'Pensamiento cr√≠tico'] },
                        { nombre: 'Comunicaci√≥n', habilidades: ['Asertividad', 'Comunicaci√≥n efectiva', 'Marca personal', 'Redacci√≥n y ortograf√≠a', 'Protocolo y etiqueta empresarial', 'Hablar en p√∫blico', 'Gesti√≥n de stakeholders'] },
                        { nombre: 'Productividad', habilidades: ['Gesti√≥n del tiempo', 'Planificaci√≥n', 'Organizaci√≥n'] },
                        { nombre: 'Gesti√≥n del cambio', habilidades: ['Orientaci√≥n a la mejora continua', 'Pensamiento sist√©mico', 'Adaptabilidad', 'Aprendizaje continuo'] },
                        { nombre: 'Negociaci√≥n', habilidades: ['Persuasi√≥n', 'Generaci√≥n de acuerdos'] },
                        { nombre: 'Wellness', habilidades: ['Salud mental y emocional', 'Salud f√≠sica', 'Balance de vida', 'Alimentaci√≥n saludable', 'Salud financiera'] },
                        { nombre: 'Liderazgo', habilidades: ['Empoderamiento', 'Motivaci√≥n', 'Pensamiento estrat√©gico', 'Coaching de equipos'] },
                        { nombre: 'Innovaci√≥n', habilidades: ['Creatividad', 'Pensamiento disruptivo', 'Ideaci√≥n', 'Pensamiento exponencial'] }
                    ]
                },
                {
                    nombre: 'Academia de Ingl√©s',
                    competencias: [
                        { nombre: 'Ingl√©s', habilidades: ['Grammar', 'Listening', 'Reading', 'Speaking', 'Writing', 'Vocabulary'] }
                    ]
                },
                {
                    nombre: 'Academia de Negocios',
                    competencias: [
                        { nombre: 'Experiencia del cliente', habilidades: ['Servicio al cliente', 'Manejo de objeciones', 'Customer Relationship Management (CRM)', 'Dise√±o de la experiencia de cliente (CX)'] },
                        { nombre: 'Marketing', habilidades: ['Branding', 'Storytelling', 'Social media'] },
                        { nombre: 'Ventas', habilidades: ['Prospecci√≥n', 'Gesti√≥n de ciclo de ventas', 'Cierre de ventas', 'Venta consultiva', 'Gesti√≥n del equipo comercial'] },
                        { nombre: 'Agilidad', habilidades: ['Agilidad de negocios', 'Metodolog√≠as √°giles'] },
                        { nombre: 'People management', habilidades: ['Cultura organizacional', 'Adquisici√≥n del talento', 'Experiencia del empleado (EX)', 'Relaciones laborales', 'Anal√≠tica de personas', 'Diversidad, equidad e inclusi√≥n', 'Gesti√≥n del desempe√±o', 'Desarrollo del talento', 'Teletrabajo'] },
                        { nombre: 'Gesti√≥n de proyectos', habilidades: ['Planeaci√≥n de proyectos', 'Control de proyectos'] },
                        { nombre: 'Gesti√≥n de procesos y operaciones', habilidades: ['Gesti√≥n de la cadena de suministro', 'Gesti√≥n de procesos', 'e-Operations', 'Retail', 'Hospitality', 'Automatizaci√≥n de procesos'] },
                        { nombre: 'Gesti√≥n financiera', habilidades: ['Planeaci√≥n financiera', 'An√°lisis de estados financieros', 'Gesti√≥n contable', 'Control financiero', 'Financial services'] },
                        { nombre: 'Administraci√≥n de negocios', habilidades: ['Estrategia', 'Control de gesti√≥n', 'An√°lisis econ√≥mico', 'Sostenibilidad y RSE'] },
                        { nombre: 'Emprendimiento', habilidades: ['Propuesta de valor', 'Modelos de negocio', 'Intraemprendimiento'] }
                    ]
                },
                {
                    nombre: 'Academia de Compliance',
                    competencias: [
                        { nombre: 'Cumplimiento (Compliance)', habilidades: ['Cumplimiento en Data & IT', 'Cumplimiento financiero', 'Gobierno corporativo', 'Sistemas de gesti√≥n HSEQ +RL', 'Cumplimiento operativo y de calidad', 'Legislaci√≥n laboral'] },
                        { nombre: 'Gesti√≥n del riesgo', habilidades: ['Riesgo operativo', 'Continuidad del negocio'] }
                    ]
                },
                {
                    nombre: 'Academia de Tecnolog√≠a',
                    competencias: [
                        { nombre: 'Data skills', habilidades: ['Administraci√≥n de bases de datos', 'An√°lisis de datos', 'Visualizaci√≥n de datos', 'Inteligencia de negocios (BI)', 'Big data', 'Probabilidad y estad√≠stica'] },
                        { nombre: 'Product design', habilidades: ['Design thinking', 'Dise√±o UX', 'Dise√±o UI', 'Prototipado', 'UX Research'] },
                        { nombre: 'Desarrollo de software', habilidades: ['Software testing', 'DevOps', 'Herramientas de desarrollo de software', 'Herramientas No Code', 'Pensamiento computacional'] },
                        { nombre: 'Lenguajes de Programaci√≥n', habilidades: ['SQL', 'Java', 'JavaScript', 'PHP', 'Python', 'NoSQL', 'Ruby', 'R', 'C Sharp (C#)'] },
                        { nombre: 'Desarrollo web', habilidades: ['Desarrollo frontend', 'Desarrollo backend', 'Dise√±o e implementaci√≥n de APIs'] },
                        { nombre: 'Herramientas tecnol√≥gicas', habilidades: ['Aplicaciones Microsoft', 'Aplicaciones Google', 'Herramientas para proyectos', 'Herramientas colaborativas', 'Herramientas de dise√±o', 'Herramientas de ventas', 'Aplicaciones Amazon', 'Sistema Linux', 'Computadores, dispositivos electr√≥nicos e internet'] },
                        { nombre: 'Digital skills', habilidades: ['Dise√±o gr√°fico digital', 'Tendencias digitales', 'Contenido digital', 'Transformaci√≥n digital'] },
                        { nombre: 'Gesti√≥n de recursos tecnol√≥gicos', habilidades: ['Arquitectura TI', 'Infraestructura tecnol√≥gica', 'Ciberseguridad', 'Derecho digital'] },
                        { nombre: 'e-Commerce', habilidades: ['Gesti√≥n de plataformas de e-commerce'] },
                        { nombre: 'Marketing digital', habilidades: ['Product marketing', 'Anal√≠tica en marketing', 'Gesti√≥n del funnel de conversi√≥n', 'Growth marketing', 'Google Analytics', 'Google Ads', 'Inbound marketing'] }
                    ]
                }
            ]
        };

        // Mapeo de nombres de competencias a archivos de imagen
        const competenciaImageMap = {
            'Accountability': 'Accountability.jpg',
            'Inteligencia emocional': 'Inteligencia emocional.jpg',
            'Trabajo en equipo': 'Trabajo en equipo.jpg',
            'Resoluci√≥n de problemas': 'Resoluci√≥n de problemas.jpg',
            'Comunicaci√≥n': 'Comunicaci√≥n.jpg',
            'Productividad': 'Productividad.jpg',
            'Gesti√≥n del cambio': 'Gesti√≥n del cambio.jpg',
            'Negociaci√≥n': 'Negociaci√≥n.jpg',
            'Wellness': 'Wellness.jpg',
            'Liderazgo': 'Liderazgo.jpg',
            'Ingl√©s': 'Ingl√©s.jpg',
            'Innovaci√≥n': 'Innovaci√≥n.jpg',
            'Experiencia del cliente': 'Experiencia del cliente.jpg',
            'Marketing': 'Marketing.jpg',
            'Ventas': 'Ventas.jpg',
            'Agilidad': 'Agilidad.jpg',
            'People management': 'People management.jpg',
            'Gesti√≥n de proyectos': 'Gesti√≥n de proyectos.jpg',
            'Gesti√≥n de procesos y operaciones': 'Gesti√≥n de procesos y operaciones.jpg',
            'Gesti√≥n financiera': 'Gesti√≥n financiera.jpg',
            'Administraci√≥n de negocios': 'Administraci√≥n de negocios.jpg',
            'Emprendimiento': 'Emprendimiento.jpg',
            'Gesti√≥n del riesgo': 'Gesti√≥n del riesgo.jpg',
            'Cumplimiento (Compliance)': 'Cumplimiento (Compliance).jpg',
            'Data skills': 'Data skills.jpg',
            'Product design': 'Product design.jpg',
            'Desarrollo de software': 'Desarrollo de software.jpg',
            'Lenguajes de Programaci√≥n': 'Lenguajes de Programaci√≥n.jpg',
            'Desarrollo web': 'Desarrollo web.jpg',
            'Herramientas tecnol√≥gicas': 'Herramientas tecnol√≥gicas.jpg',
            'Digital skills': 'Digital skills.jpg',
            'Gesti√≥n de recursos tecnol√≥gicos': 'Gesti√≥n de recursos tecnol√≥gicos.jpg',
            'e-Commerce': 'e-Commerce.jpg',
            'Marketing digital': 'Marketing digital.jpg'
        };

        // Im√°genes placeholder para academias (usando Unsplash)
        const academiaImageMap = {
            'Academia de Habilidades Blandas': '../../images/academias/academia-habilidades-blandas.jpg',
            'Academia de Ingl√©s': '../../images/academias/academia-ingles.jpg',
            'Academia de Negocios': '../../images/academias/academia-negocios.jpg',
            'Academia de Compliance': '../../images/academias/academia-compliance.jpg',
            'Academia de Tecnolog√≠a': '../../images/academias/academia-tecnologia.jpg'
        };

        // Iconos para habilidades
        const habilidadIconMap = {
            'Autogesti√≥n': 'fa-user-check',
            'Proactividad': 'fa-rocket',
            'Integridad': 'fa-shield-check',
            'Empat√≠a': 'fa-heart',
            'Autoconocimiento': 'fa-brain',
            'Autorregulaci√≥n': 'fa-balance-scale',
            'Autocompasi√≥n': 'fa-hands-helping',
            'Resiliencia': 'fa-dumbbell',
            'Trabajo colaborativo': 'fa-users',
            'Gesti√≥n del conflicto': 'fa-handshake',
            'Relacionamiento': 'fa-network-wired',
            'An√°lisis de escenarios': 'fa-chart-line',
            'Toma de decisiones': 'fa-check-circle',
            'Pensamiento cr√≠tico': 'fa-lightbulb',
            'Asertividad': 'fa-comments',
            'Comunicaci√≥n efectiva': 'fa-bullhorn',
            'Marca personal': 'fa-user-tag',
            'Redacci√≥n y ortograf√≠a': 'fa-pen',
            'Protocolo y etiqueta empresarial': 'fa-handshake',
            'Hablar en p√∫blico': 'fa-microphone',
            'Gesti√≥n de stakeholders': 'fa-users-cog',
            'Gesti√≥n del tiempo': 'fa-clock',
            'Planificaci√≥n': 'fa-calendar-check',
            'Organizaci√≥n': 'fa-folder-open',
            'Orientaci√≥n a la mejora continua': 'fa-chart-line',
            'Pensamiento sist√©mico': 'fa-project-diagram',
            'Adaptabilidad': 'fa-sync',
            'Aprendizaje continuo': 'fa-graduation-cap',
            'Persuasi√≥n': 'fa-comments-dollar',
            'Generaci√≥n de acuerdos': 'fa-handshake',
            'Salud mental y emocional': 'fa-heart',
            'Salud f√≠sica': 'fa-dumbbell',
            'Balance de vida': 'fa-balance-scale',
            'Alimentaci√≥n saludable': 'fa-apple-alt',
            'Salud financiera': 'fa-wallet',
            'Empoderamiento': 'fa-crown',
            'Motivaci√≥n': 'fa-fire',
            'Pensamiento estrat√©gico': 'fa-chess',
            'Coaching de equipos': 'fa-users-cog',
            'Grammar': 'fa-book',
            'Listening': 'fa-headphones',
            'Reading': 'fa-book-open',
            'Speaking': 'fa-microphone',
            'Writing': 'fa-pen-fancy',
            'Vocabulary': 'fa-book-reader',
            'Creatividad': 'fa-palette',
            'Pensamiento disruptivo': 'fa-lightbulb',
            'Ideaci√≥n': 'fa-lightbulb-on',
            'Pensamiento exponencial': 'fa-chart-line',
            'Servicio al cliente': 'fa-headset',
            'Manejo de objeciones': 'fa-comments',
            'Customer Relationship Management (CRM)': 'fa-address-book',
            'Dise√±o de la experiencia de cliente (CX)': 'fa-smile',
            'Branding': 'fa-tag',
            'Storytelling': 'fa-book',
            'Social media': 'fa-share-alt',
            'Prospecci√≥n': 'fa-search',
            'Gesti√≥n de ciclo de ventas': 'fa-sync',
            'Cierre de ventas': 'fa-handshake',
            'Venta consultiva': 'fa-comments-dollar',
            'Gesti√≥n del equipo comercial': 'fa-users',
            'Agilidad de negocios': 'fa-tachometer-alt',
            'Metodolog√≠as √°giles': 'fa-project-diagram',
            'Cultura organizacional': 'fa-building',
            'Adquisici√≥n del talento': 'fa-user-plus',
            'Experiencia del empleado (EX)': 'fa-user-check',
            'Relaciones laborales': 'fa-handshake',
            'Anal√≠tica de personas': 'fa-chart-bar',
            'Diversidad, equidad e inclusi√≥n': 'fa-users',
            'Gesti√≥n del desempe√±o': 'fa-chart-line',
            'Desarrollo del talento': 'fa-user-graduate',
            'Teletrabajo': 'fa-laptop',
            'Planeaci√≥n de proyectos': 'fa-calendar-alt',
            'Control de proyectos': 'fa-tasks',
            'Gesti√≥n de la cadena de suministro': 'fa-truck',
            'Gesti√≥n de procesos': 'fa-cogs',
            'e-Operations': 'fa-server',
            'Retail': 'fa-store',
            'Hospitality': 'fa-hotel',
            'Automatizaci√≥n de procesos': 'fa-robot',
            'Planeaci√≥n financiera': 'fa-chart-pie',
            'An√°lisis de estados financieros': 'fa-file-invoice-dollar',
            'Gesti√≥n contable': 'fa-calculator',
            'Control financiero': 'fa-wallet',
            'Financial services': 'fa-university',
            'Estrategia': 'fa-chess',
            'Control de gesti√≥n': 'fa-clipboard-check',
            'An√°lisis econ√≥mico': 'fa-chart-line',
            'Sostenibilidad y RSE': 'fa-leaf',
            'Propuesta de valor': 'fa-gem',
            'Modelos de negocio': 'fa-briefcase',
            'Intraemprendimiento': 'fa-rocket',
            'Riesgo operativo': 'fa-exclamation-triangle',
            'Continuidad del negocio': 'fa-shield-alt',
            'Cumplimiento en Data & IT': 'fa-database',
            'Cumplimiento financiero': 'fa-file-invoice',
            'Gobierno corporativo': 'fa-building',
            'Sistemas de gesti√≥n HSEQ +RL': 'fa-clipboard-check',
            'Cumplimiento operativo y de calidad': 'fa-check-circle',
            'Legislaci√≥n laboral': 'fa-gavel',
            'Administraci√≥n de bases de datos': 'fa-database',
            'An√°lisis de datos': 'fa-chart-bar',
            'Visualizaci√≥n de datos': 'fa-chart-pie',
            'Inteligencia de negocios (BI)': 'fa-brain',
            'Big data': 'fa-server',
            'Probabilidad y estad√≠stica': 'fa-chart-line',
            'Design thinking': 'fa-lightbulb',
            'Dise√±o UX': 'fa-mouse-pointer',
            'Dise√±o UI': 'fa-palette',
            'Prototipado': 'fa-drafting-compass',
            'UX Research': 'fa-search',
            'Software testing': 'fa-vial',
            'DevOps': 'fa-code-branch',
            'Herramientas de desarrollo de software': 'fa-tools',
            'Herramientas No Code': 'fa-magic',
            'Pensamiento computacional': 'fa-brain',
            'SQL': 'fa-database',
            'Java': 'fa-coffee',
            'JavaScript': 'fa-code',
            'PHP': 'fa-code',
            'Python': 'fa-code',
            'NoSQL': 'fa-database',
            'Ruby': 'fa-gem',
            'R': 'fa-chart-bar',
            'C Sharp (C#)': 'fa-code',
            'Desarrollo frontend': 'fa-laptop-code',
            'Desarrollo backend': 'fa-server',
            'Dise√±o e implementaci√≥n de APIs': 'fa-plug',
            'Aplicaciones Microsoft': 'fa-windows',
            'Aplicaciones Google': 'fa-google',
            'Herramientas para proyectos': 'fa-tasks',
            'Herramientas colaborativas': 'fa-users',
            'Herramientas de dise√±o': 'fa-palette',
            'Herramientas de ventas': 'fa-handshake',
            'Aplicaciones Amazon': 'fa-amazon',
            'Sistema Linux': 'fa-linux',
            'Computadores, dispositivos electr√≥nicos e internet': 'fa-desktop',
            'Dise√±o gr√°fico digital': 'fa-paint-brush',
            'Tendencias digitales': 'fa-trending-up',
            'Contenido digital': 'fa-file-alt',
            'Transformaci√≥n digital': 'fa-sync',
            'Arquitectura TI': 'fa-network-wired',
            'Infraestructura tecnol√≥gica': 'fa-server',
            'Ciberseguridad': 'fa-shield-alt',
            'Derecho digital': 'fa-gavel',
            'Gesti√≥n de plataformas de e-commerce': 'fa-shopping-cart',
            'Product marketing': 'fa-bullhorn',
            'Anal√≠tica en marketing': 'fa-chart-bar',
            'Gesti√≥n del funnel de conversi√≥n': 'fa-filter',
            'Growth marketing': 'fa-chart-line',
            'Google Analytics': 'fa-chart-bar',
            'Google Ads': 'fa-ad',
            'Inbound marketing': 'fa-arrow-down'
        };

        // Cargar componentes din√°micamente
        document.addEventListener('DOMContentLoaded', function() {
            loadSidebar('sidebar-container', 'aprendizaje');
            loadSubNav('top-nav-container', 'aprendizaje');
            loadTabBar('tab-bar-container');
            loadFloatingMenu('floating-menu-container');
            loadProfileMenu('profile-menu-container');

            // Base de datos de sugerencias
            const searchSuggestions = {
                'ia': [
                    'Inteligencia artificial',
                    'Inteligencia artificial y √©tica',
                    'M√°ster de inteligencia artificial para agentes de viajes',
                    'Introduccion a la inteligencia artificial',
                    'Herramientas de inteligencia artificial',
                    'Inteligencia artificial como potenciador de un negocio',
                    'Genera videos con inteligencia artificial',
                    'Inteligencia artificial y su impacto en ventas',
                    'Casos practicos de inteligencia artificial',
                    'Inteligencia artificial generativa'
                ]
            };
            
            // Funci√≥n para mostrar sugerencias - KISS: simple y directo
            function showSuggestions(query) {
                const suggestionsContainer = document.getElementById('search-suggestions-container');
                if (!suggestionsContainer) {
                    console.error('‚ùå No se encontr√≥ el contenedor de sugerencias');
                    return;
                }
                
                const normalizedQuery = query.toLowerCase().trim();
                console.log('üîç Buscando sugerencias para:', normalizedQuery);
                
                if (normalizedQuery.length === 0) {
                    suggestionsContainer.classList.remove('visible');
                    return;
                }
                
                // Buscar sugerencias
                let suggestions = [];
                
                // Buscar coincidencias exactas
                for (const [key, values] of Object.entries(searchSuggestions)) {
                    if (normalizedQuery.includes(key) || key.includes(normalizedQuery)) {
                        suggestions = values.slice(0, 8);
                        break;
                    }
                }
                
                // Si no hay coincidencias, buscar en el contenido
                if (suggestions.length === 0) {
                    for (const [key, values] of Object.entries(searchSuggestions)) {
                        const matching = values.filter(s => s.toLowerCase().includes(normalizedQuery));
                        if (matching.length > 0) {
                            suggestions = matching.slice(0, 8);
                            break;
                        }
                    }
                }
                
                if (suggestions.length > 0) {
                    console.log('‚úÖ Encontradas', suggestions.length, 'sugerencias');
                    suggestionsContainer.innerHTML = suggestions.map(suggestion => `
                        <div class="search-suggestion-item">
                            <span class="suggestion-text">${suggestion}</span>
                        </div>
                    `).join('');
                    
                    suggestionsContainer.classList.add('visible');
                    
                    // Listeners para clic en sugerencias
                    suggestionsContainer.querySelectorAll('.search-suggestion-item').forEach(item => {
                        item.addEventListener('click', function() {
                            const searchInput = document.querySelector('#catalog-search-container input');
                            if (searchInput) {
                                searchInput.value = this.querySelector('.suggestion-text').textContent;
                                suggestionsContainer.classList.remove('visible');
                                searchInput.focus();
                                searchInput.dispatchEvent(new Event('input', { bubbles: true }));
                            }
                        });
                    });
                } else {
                    console.log('‚ùå No se encontraron sugerencias');
                    suggestionsContainer.classList.remove('visible');
                }
            }

            // Crear input de b√∫squeda
            setTimeout(() => {
                createInput({
                    containerId: 'catalog-search-container',
                    type: 'search',
                    placeholder: 'Buscar un tema, competencia o habilidad...',
                    size: 'lg',
                    onChange: function(value) {
                        // Cuando se limpia el input (bot√≥n X), ocultar sugerencias
                        if (value === '') {
                            const suggestionsContainer = document.getElementById('search-suggestions-container');
                            if (suggestionsContainer) {
                                suggestionsContainer.classList.remove('visible');
                            }
                        }
                    }
                });

                // Agregar listener de b√∫squeda y sugerencias - KISS: simple y directo
                setTimeout(() => {
                    const searchInput = document.querySelector('#catalog-search-container input');
                    const searchContainer = document.getElementById('catalog-search-container');
                    
                    console.log('üîç Setup sugerencias:', { searchInput: !!searchInput, searchContainer: !!searchContainer });
                    
                    if (!searchInput || !searchContainer) {
                        console.error('‚ùå No se encontraron elementos necesarios');
                        return;
                    }
                    
                    // KISS: Crear contenedor de sugerencias y moverlo al div con position: relative que crea createInput
                    let suggestionsContainer = document.getElementById('search-suggestions-container');
                    if (!suggestionsContainer) {
                        suggestionsContainer = document.createElement('div');
                        suggestionsContainer.id = 'search-suggestions-container';
                        suggestionsContainer.className = 'search-suggestions-container';
                    }
                    
                    // Mover el contenedor de sugerencias al div con position: relative que crea createInput
                    const inputWrapper = searchInput.parentElement; // El div con position: relative
                    if (inputWrapper) {
                        inputWrapper.style.position = 'relative';
                        inputWrapper.style.zIndex = '1000';
                        
                        // Agregar botones dentro del input
                        let buttonsContainer = inputWrapper.querySelector('.catalog-search-input-buttons');
                        if (!buttonsContainer) {
                            buttonsContainer = document.createElement('div');
                            buttonsContainer.className = 'catalog-search-input-buttons';
                            
                            // Bot√≥n de filtros (terciario, icon-only, sm)
                            const filterButton = document.createElement('button');
                            filterButton.className = 'ubits-button ubits-button--tertiary ubits-button--sm ubits-button--icon-only';
                            filterButton.setAttribute('aria-label', 'Filtros');
                            filterButton.innerHTML = '<i class="far fa-filter"></i>';
                            filterButton.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                console.log('üîç Filtros clickeado');
                                // Aqu√≠ puedes agregar la l√≥gica de filtros
                            });
                            
                            // Bot√≥n de Modo IA (ia-button secundario, sm)
                            const iaButton = document.createElement('button');
                            iaButton.className = 'ubits-ia-button ubits-ia-button--secondary ubits-ia-button--sm';
                            iaButton.innerHTML = '<i class="far fa-sparkles"></i><span>Modo IA</span>';
                            iaButton.addEventListener('click', function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                                console.log('ü§ñ Modo IA clickeado');
                                // Redirigir a modo-estudio-ia.html
                                window.location.href = 'modo-estudio-ia.html';
                            });
                            
                            buttonsContainer.appendChild(filterButton);
                            buttonsContainer.appendChild(iaButton);
                            inputWrapper.appendChild(buttonsContainer);
                            console.log('‚úÖ Botones agregados dentro del input');
                        }
                        
                        inputWrapper.appendChild(suggestionsContainer);
                        console.log('‚úÖ Contenedor de sugerencias movido al wrapper del input');
                    } else {
                        // Fallback: usar el contenedor padre
                        searchContainer.style.position = 'relative';
                        searchContainer.style.zIndex = '1000';
                        searchContainer.appendChild(suggestionsContainer);
                    }
                    
                    // Listener simple para input
                    // Listener simple para input - solo mostrar sugerencias, no buscar
                    searchInput.addEventListener('input', function(e) {
                        const value = this.value;
                        console.log('üìù Input cambiado:', value);
                        
                        // Si el input est√° vac√≠o, ocultar sugerencias
                        if (value === '') {
                            const suggestionsContainer = document.getElementById('search-suggestions-container');
                            if (suggestionsContainer) {
                                suggestionsContainer.classList.remove('visible');
                            }
                        } else {
                            // Solo mostrar sugerencias si hay texto
                            showSuggestions(value);
                        }
                        // NO llamar handleSearch - la b√∫squeda est√° desactivada
                    });
                    
                    // Listener para bot√≥n X (limpiar)
                    const clearIcon = searchContainer.querySelector('i[class*="fa-times"]');
                    if (clearIcon) {
                        clearIcon.addEventListener('click', function() {
                            console.log('‚ùå Bot√≥n X clickeado');
                            suggestionsContainer.classList.remove('visible');
                        });
                    }
                    
                    // Ocultar al hacer clic fuera
                    document.addEventListener('click', function(e) {
                        if (!searchContainer.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                            suggestionsContainer.classList.remove('visible');
                        }
                    });
                }, 1000);
            }, 300);

            // Renderizar chips de b√∫squedas frecuentes
            renderChips();

            // Renderizar cat√°logo inicial
            renderCatalog(catalogData.academias);

            // Renderizar aliados destacados usando componente oficial
            if (typeof createCarouselContents === 'function') {
                createCarouselContents({
                    containerId: 'aliados-container',
                    type: 'allies',
                    sectionTitle: 'Explora por aliados destacados',
                    slides: [
                        {
                            name: 'UBITS',
                            logo: '../../images/Favicons/UBITS.jpg'
                        },
                        {
                            name: 'Microsoft',
                            logo: '../../images/Favicons/Microsoft.jpg'
                        },
                        {
                            name: 'TED',
                            logo: '../../images/Favicons/TED.jpg'
                        },
                        {
                            name: 'Harvard Business Publishing',
                            logo: '../../images/Favicons/Harvard-Business-Publishing.jpg'
                        },
                        {
                            name: 'All Ears English',
                            logo: '../../images/Favicons/All Ears English.jpg'
                        },
                        {
                            name: 'IE University Publishing',
                            logo: '../../images/Favicons/IE-University-Publishing.jpg'
                        },
                        {
                            name: 'WOBI',
                            logo: '../../images/Favicons/WOBI.jpg'
                        },
                        {
                            name: 'Hubspot',
                            logo: '../../images/Favicons/Hubspot.jpg'
                        },
                        {
                            name: 'AWS',
                            logo: '../../images/Favicons/AWS.jpg'
                        },
                        {
                            name: 'C√≥digo Facilito',
                            logo: '../../images/Favicons/C√≥digo-Facilito.jpg'
                        },
                        {
                            name: 'Universidad de Los Andes',
                            logo: '../../images/Favicons/Universidad-de-Los Andes.jpg'
                        },
                        {
                            name: 'Welu',
                            logo: '../../images/Favicons/Welu.jpg'
                        }
                    ],
                    onButtonClick: function(ally, index) {
                        console.log('Ally clicked:', ally.name, 'Index:', index);
                        // Aqu√≠ puedes agregar la l√≥gica de filtrado por aliado
                    }
                });
            }
            
            // Renderizar tipos de contenido (nuevo carrusel) - con delay para asegurar que el DOM est√© listo
            setTimeout(() => {
                renderTiposContenidoNuevo();
            }, 100);

            // Listener de resize para actualizar el cat√°logo din√°micamente
            let resizeTimeout;
            let lastWindowWidth = window.innerWidth;
            let isRendering = false; // Flag para prevenir re-renders infinitos
            window.addEventListener('resize', function() {
                // Prevenir re-render si ya se est√° renderizando
                if (isRendering) return;
                
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(function() {
                    const currentWidth = window.innerWidth;
                    // Determinar n√∫mero de columnas seg√∫n el ancho
                    let numColumns = 3;
                    if (currentWidth <= 768) {
                        numColumns = 1;
                    } else if (currentWidth <= 1023) {
                        numColumns = 2;
                    }
                    
                    // Determinar n√∫mero de columnas del ancho anterior
                    let lastNumColumns = 3;
                    if (lastWindowWidth <= 768) {
                        lastNumColumns = 1;
                    } else if (lastWindowWidth <= 1023) {
                        lastNumColumns = 2;
                    }
                    
                    // Solo re-renderizar si cambi√≥ el n√∫mero de columnas
                    if (numColumns !== lastNumColumns) {
                        isRendering = true; // Marcar que se est√° renderizando
                        
                        // Guardar estado actual (academias y competencias expandidas)
                        const expandedAcademias = [];
                        document.querySelectorAll('.academia-card-spotify.expanded').forEach(card => {
                            expandedAcademias.push(card.dataset.academia);
                        });
                        
                        const expandedCompetencias = [];
                        document.querySelectorAll('.competencia-card-v1.expanded').forEach(card => {
                            expandedCompetencias.push({
                                competencia: card.dataset.competencia,
                                academia: card.dataset.academia
                            });
                        });
                        
                        // Re-renderizar cat√°logo completo (b√∫squeda desactivada)
                        renderCatalog(catalogData.academias);
                        
                        // Restaurar estado
                        setTimeout(() => {
                            expandedAcademias.forEach(academiaNombre => {
                                const card = document.querySelector(`.academia-card-spotify[data-academia="${academiaNombre}"]`);
                                const container = document.querySelector(`.academia-competencias-container[data-academia="${academiaNombre}"]`);
                                if (card && container) {
                                    card.classList.add('expanded');
                                    container.classList.add('is-visible');
                                }
                            });
                            
                            expandedCompetencias.forEach(({ competencia, academia }) => {
                                const card = document.querySelector(`.competencia-card-v1[data-competencia="${competencia}"][data-academia="${academia}"]`);
                                const container = document.querySelector(`.competencia-habilidades-container[data-competencia="${competencia}"][data-academia="${academia}"]`);
                                if (card && container) {
                                    card.classList.add('expanded');
                                    container.classList.add('is-visible');
                                    // Restaurar rotaci√≥n del chevron
                                    const chevronBtn = card.querySelector('.competencia-card-v1-chevron-btn');
                                    if (chevronBtn) {
                                        const chevronIcon = chevronBtn.querySelector('.competencia-card-v1-chevron');
                                        if (chevronIcon) {
                                            chevronIcon.style.transform = 'rotate(180deg)';
                                        }
                                    }
                                }
                            });
                            
                            isRendering = false; // Marcar que termin√≥ el renderizado
                        }, 50);
                        
                        lastWindowWidth = currentWidth;
                    }
                }, 150);
            });

            // Hacer funciones accesibles globalmente
            window.handleChipClick = handleChipClick;

            // Activar el tab "Cat√°logo"
            setTimeout(() => {
                document.querySelectorAll('.nav-tab, .hamburger-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                const catalogTab = document.querySelector('.nav-tab[data-tab="catalog"]');
                if (catalogTab) catalogTab.classList.add('active');
                
                const catalogHamburger = document.querySelector('.hamburger-item[data-tab="catalog"]');
                if (catalogHamburger) catalogHamburger.classList.add('active');
                
                const aprendizajeButton = document.querySelector('.nav-button[data-section="aprendizaje"]');
                if (aprendizajeButton) {
                    document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
                    aprendizajeButton.classList.add('active');
                }
                
                const modulosTabBarItem = document.querySelector('.tab-bar-item[data-tab="modulos"]');
                if (modulosTabBarItem) {
                    document.querySelectorAll('.tab-bar-item').forEach(item => item.classList.remove('active'));
                    modulosTabBarItem.classList.add('active');
                }
                
                if (typeof setActiveAccordionLink === 'function') {
                    setActiveAccordionLink('catalogo');
                }
            }, 200);
        });

        // Funci√≥n para renderizar chips de b√∫squedas frecuentes
        function renderChips() {
            const busquedasFrecuentes = [
                'Liderazgo',
                'Product Design',
                'Marketing Digital',
                'Desarrollo de Software',
                'Data Skills'
            ];

            const chipsContainer = document.getElementById('catalog-chips');
            chipsContainer.innerHTML = busquedasFrecuentes.map(busqueda => `
                <div class="catalog-chip" onclick="handleChipClick('${busqueda}')">
                    <span class="ubits-body-sm-regular">${busqueda}</span>
                </div>
            `).join('');
        }

        // Funci√≥n para manejar click en chip
        function handleChipClick(busqueda) {
            const searchInput = document.querySelector('#catalog-search-container input');
            if (searchInput) {
                searchInput.value = busqueda;
                searchInput.dispatchEvent(new Event('input', { bubbles: true }));
            }
        }

        // Funci√≥n de b√∫squeda - DESACTIVADA (solo para dise√±o, no funcional)
        // En la vida real, esto enviar√≠a a una p√°gina de resultados de b√∫squeda
        function handleSearch(event) {
            // La b√∫squeda est√° desactivada - no hacer nada
            return;
        }

        // Funci√≥n para renderizar el cat√°logo
        // Funci√≥n para renderizar tipos de contenido

        // Funci√≥n para renderizar el nuevo carrusel de tipos de contenido (rectangular)
        function renderTiposContenidoNuevo() {
            const carouselContainer = document.getElementById('tipos-contenido-carousel-nuevo');
            if (!carouselContainer) {
                console.error('No se encontr√≥ el contenedor tipos-contenido-carousel-nuevo');
                return;
            }

            // Tipos de contenido oficiales (de la v2)
            const tiposContenido = [
                'Curso',
                'Short',
                'Charla',
                'Art√≠culo',
                'Podcast',
                'Libro',
                'Ideas de libro',
                'Caso de estudio',
                'Documento t√©cnico',
                'Ejercicios de pr√°ctica',
                'Ruta de aprendizaje',
                'Programa'
            ];

            // Mapeo de iconos por tipo de contenido (de la v2)
            const iconosPorTipo = {
                'Curso': 'fa-graduation-cap',
                'Short': 'fa-capsules',
                'Charla': 'fa-comments',
                'Art√≠culo': 'fa-file-lines',
                'Podcast': 'fa-podcast',
                'Libro': 'fa-book',
                'Ideas de libro': 'fa-lightbulb',
                'Caso de estudio': 'fa-briefcase',
                'Documento t√©cnico': 'fa-file-code',
                'Ejercicios de pr√°ctica': 'fa-dumbbell',
                'Ruta de aprendizaje': 'fa-route',
                'Programa': 'fa-network-wired'
            };

            const htmlContent = tiposContenido.map(tipo => {
                const icono = iconosPorTipo[tipo] || 'fa-circle';
                
                return `
                    <div class="tipo-contenido-card-nuevo" data-tipo="${tipo}">
                        <div class="tipo-contenido-icon-nuevo">
                            <i class="far ${icono}"></i>
                        </div>
                        <span class="ubits-body-sm-regular tipo-contenido-name-nuevo">${tipo}</span>
                    </div>
                `;
            }).join('');
            
            carouselContainer.innerHTML = htmlContent;

            // Agregar event listeners para los cards
            carouselContainer.querySelectorAll('.tipo-contenido-card-nuevo').forEach(card => {
                card.addEventListener('click', function() {
                    const tipo = this.dataset.tipo;
                    // Aqu√≠ puedes agregar la l√≥gica de filtrado por tipo de contenido
                    console.log('Tipo seleccionado:', tipo);
                });
            });

            // Agregar event listeners para los botones de control del carrusel
            const prevButton = document.getElementById('tipos-contenido-nuevo-prev');
            const nextButton = document.getElementById('tipos-contenido-nuevo-next');

            // Funci√≥n para obtener el n√∫mero de items a mover seg√∫n el breakpoint
            function getItemsToMoveNuevo() {
                if (window.innerWidth <= 768) {
                    return 3; // Mobile
                } else if (window.innerWidth <= 1023) {
                    return 5; // Tablet
                }
                return 8; // Desktop
            }

            // Funci√≥n para obtener el √≠ndice del primer item visible
            function getFirstVisibleIndexNuevo() {
                const cards = carouselContainer.querySelectorAll('.tipo-contenido-card-nuevo');
                if (cards.length === 0) return 0;

                const containerRect = carouselContainer.getBoundingClientRect();
                for (let i = 0; i < cards.length; i++) {
                    const cardRect = cards[i].getBoundingClientRect();
                    if (cardRect.left >= containerRect.left) {
                        return i;
                    }
                }
                return 0;
            }

            // Funci√≥n para actualizar el estado de los botones
            function updateCarouselButtonsNuevo() {
                if (!carouselContainer || !prevButton || !nextButton) return;

                const scrollLeft = carouselContainer.scrollLeft;
                const scrollWidth = carouselContainer.scrollWidth;
                const clientWidth = carouselContainer.clientWidth;
                const isAtStart = scrollLeft <= 0;
                const isAtEnd = scrollLeft + clientWidth >= scrollWidth - 1;

                prevButton.disabled = isAtStart;
                nextButton.disabled = isAtEnd;
            }

            // Scroll al siguiente grupo de items
            function scrollToNextGroupNuevo() {
                const cards = carouselContainer.querySelectorAll('.tipo-contenido-card-nuevo');
                if (cards.length === 0) return;
                
                const itemsToMove = getItemsToMoveNuevo();
                const currentIndex = getFirstVisibleIndexNuevo();
                const nextIndex = Math.min(cards.length - 1, currentIndex + itemsToMove);
                
                if (nextIndex === currentIndex) {
                    setTimeout(updateCarouselButtonsNuevo, 400);
                    return;
                }
                
                const targetCard = cards[nextIndex];
                const targetCardRect = targetCard.getBoundingClientRect();
                const containerRect = carouselContainer.getBoundingClientRect();
                const scrollLeft = carouselContainer.scrollLeft;
                
                carouselContainer.scrollTo({
                    left: scrollLeft + (targetCardRect.left - containerRect.left),
                    behavior: 'smooth'
                });
                
                setTimeout(updateCarouselButtonsNuevo, 400);
            }

            // Scroll al grupo anterior de items
            function scrollToPrevGroupNuevo() {
                const cards = carouselContainer.querySelectorAll('.tipo-contenido-card-nuevo');
                if (cards.length === 0) return;
                
                const itemsToMove = getItemsToMoveNuevo();
                const currentIndex = getFirstVisibleIndexNuevo();
                const prevIndex = Math.max(0, currentIndex - itemsToMove);
                
                if (prevIndex === currentIndex) {
                    setTimeout(updateCarouselButtonsNuevo, 400);
                    return;
                }
                
                const targetCard = cards[prevIndex];
                const targetCardRect = targetCard.getBoundingClientRect();
                const containerRect = carouselContainer.getBoundingClientRect();
                const scrollLeft = carouselContainer.scrollLeft;
                
                carouselContainer.scrollTo({
                    left: scrollLeft + (targetCardRect.left - containerRect.left),
                    behavior: 'smooth'
                });
                
                setTimeout(updateCarouselButtonsNuevo, 400);
            }

            if (prevButton && nextButton) {
                // Inicializar estado de los botones
                updateCarouselButtonsNuevo();

                // Bot√≥n anterior
                prevButton.addEventListener('click', function() {
                    if (this.disabled) return;
                    scrollToPrevGroupNuevo();
                });

                // Bot√≥n siguiente
                nextButton.addEventListener('click', function() {
                    if (this.disabled) return;
                    scrollToNextGroupNuevo();
                });

                // Actualizar estado al hacer scroll
                carouselContainer.addEventListener('scroll', function() {
                    setTimeout(updateCarouselButtonsNuevo, 100);
                });

                // Actualizar estado al redimensionar la ventana
                window.addEventListener('resize', function() {
                    setTimeout(updateCarouselButtonsNuevo, 100);
                });
            }
        }

        // Event delegation para evitar listeners duplicados
        let catalogEventListenersAttached = false;
        
        function attachCatalogEventListeners() {
            // Solo agregar listeners una vez usando event delegation
            if (catalogEventListenersAttached) return;
            catalogEventListenersAttached = true;
            
            const resultsContainer = document.getElementById('catalog-results');
            
            // Event delegation para academias
            resultsContainer.addEventListener('click', function(e) {
                const academiaCard = e.target.closest('.academia-card-spotify');
                if (academiaCard) {
                    e.stopPropagation();
                    const academiaNombre = academiaCard.dataset.academia;
                    const competenciasContainer = document.querySelector(`.academia-competencias-container[data-academia="${academiaNombre}"]`);
                    const isCurrentlyExpanded = academiaCard.classList.contains('expanded');
                    
                    // Cerrar todas las academias abiertas
                    document.querySelectorAll('.academia-card-spotify.expanded').forEach(openCard => {
                        if (openCard !== academiaCard) {
                            openCard.classList.remove('expanded');
                            const openAcademiaNombre = openCard.dataset.academia;
                            const openContainer = document.querySelector(`.academia-competencias-container[data-academia="${openAcademiaNombre}"]`);
                            if (openContainer) {
                                openContainer.classList.remove('is-visible');
                            }
                        }
                    });
                    
                    // Toggle la academia clickeada
                    if (competenciasContainer) {
                        if (isCurrentlyExpanded) {
                            // Si ya estaba abierta, cerrarla
                            academiaCard.classList.remove('expanded');
                            competenciasContainer.classList.remove('is-visible');
                        } else {
                            // Si estaba cerrada, abrirla
                            academiaCard.classList.add('expanded');
                            competenciasContainer.classList.add('is-visible');
                            
                            // Scroll suave al contenedor (sin causar resize)
                            requestAnimationFrame(() => {
                                competenciasContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                            });
                        }
                    }
                    return;
                }
                
                // Event delegation para competencias
                const competenciaCard = e.target.closest('.competencia-card-v1');
                if (competenciaCard) {
                    // Si el clic fue en el bot√≥n de filtro, no hacer nada
                    if (e.target.closest('.ubits-button[data-tooltip="Filtrar por esta competencia"]')) {
                        return;
                    }
                    
                    e.stopPropagation();
                    const competenciaNombre = competenciaCard.dataset.competencia;
                    const academiaNombre = competenciaCard.dataset.academia;
                    const habilidadesContainer = document.querySelector(`.competencia-habilidades-container[data-competencia="${competenciaNombre}"][data-academia="${academiaNombre}"]`);
                    const chevronBtn = competenciaCard.querySelector('.competencia-card-v1-chevron-btn');
                    const chevronIcon = chevronBtn ? chevronBtn.querySelector('.competencia-card-v1-chevron') : null;
                    const isCurrentlyExpanded = competenciaCard.classList.contains('expanded');
                    
                    // Cerrar todas las competencias expandidas
                    document.querySelectorAll('.competencia-card-v1.expanded').forEach(openCard => {
                        if (openCard !== competenciaCard) {
                            openCard.classList.remove('expanded');
                            const openCompetenciaNombre = openCard.dataset.competencia;
                            const openAcademiaNombre = openCard.dataset.academia;
                            const openContainer = document.querySelector(`.competencia-habilidades-container[data-competencia="${openCompetenciaNombre}"][data-academia="${openAcademiaNombre}"]`);
                            if (openContainer) {
                                openContainer.classList.remove('is-visible');
                            }
                            // Resetear chevron de otras cards
                            const openChevronBtn = openCard.querySelector('.competencia-card-v1-chevron-btn');
                            if (openChevronBtn) {
                                const openChevronIcon = openChevronBtn.querySelector('.competencia-card-v1-chevron');
                                if (openChevronIcon) {
                                    openChevronIcon.style.transform = '';
                                }
                            }
                        }
                    });
                    
                    // Toggle la competencia clickeada
                    if (habilidadesContainer) {
                        if (isCurrentlyExpanded) {
                            // Si ya estaba expandida, colapsarla
                            competenciaCard.classList.remove('expanded');
                            habilidadesContainer.classList.remove('is-visible');
                            if (chevronIcon) {
                                chevronIcon.style.transform = '';
                            }
                        } else {
                            // Si estaba colapsada, expandirla
                            competenciaCard.classList.add('expanded');
                            habilidadesContainer.classList.add('is-visible');
                            if (chevronIcon) {
                                chevronIcon.style.transform = 'rotate(180deg)';
                            }
                        }
                    }
                    return;
                }
                
                // Event delegation para bot√≥n de filtro
                const filterButton = e.target.closest('.ubits-button[data-tooltip="Filtrar por esta competencia"]');
                if (filterButton) {
                    e.stopPropagation();
                    // No hacer nada, esta funcionalidad se implementar√° en el futuro
                    return;
                }
            });
        }

        function renderCatalog(academias) {
            const resultsContainer = document.getElementById('catalog-results');
            
            if (academias.length === 0) {
                resultsContainer.innerHTML = '';
                return;
            }

            // Renderizar grid de academias
            let academiasHtml = '<div class="academias-grid-spotify">';
            
            academias.forEach(academia => {
                const totalCompetencias = academia.competencias.length;
                // Dividir el nombre: "Academia de" arriba, resto abajo
                const nombreCompleto = academia.nombre;
                const partes = nombreCompleto.split('Academia de ');
                const prefijo = 'Academia de';
                const resto = partes.length > 1 ? partes[1] : nombreCompleto;
                
                // Obtener imagen
                const academiaImage = academiaImageMap[academia.nombre] || 'https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=400&h=400&fit=crop';
                
                // Todas las academias usan card cuadrada original (imagen de fondo)
                academiasHtml += `
                    <div class="academia-card-spotify" data-academia="${academia.nombre}" style="background-image: url('${academiaImage}');">
                        <div class="academia-card-spotify-content">
                            <p class="ubits-body-md-semibold academia-card-spotify-title">
                                <span>${prefijo}</span><br>
                                <span>${resto}</span>
                            </p>
                            <p class="ubits-body-sm-regular academia-card-spotify-meta">${totalCompetencias} competencias</p>
                        </div>
                    </div>
                `;
            });
            
            academiasHtml += '</div>';

            // Renderizar contenedores de competencias (inicialmente ocultos)
            let competenciasHtml = '';
            
            academias.forEach(academia => {
                // Ordenar competencias alfab√©ticamente
                const competenciasOrdenadas = [...academia.competencias].sort((a, b) => 
                    a.nombre.localeCompare(b.nombre, 'es', { sensitivity: 'base' })
                );
                
                // Determinar n√∫mero de columnas seg√∫n el ancho de la pantalla
                let numColumns = 3; // Desktop por defecto
                if (window.innerWidth <= 768) {
                    numColumns = 1; // Mobile
                } else if (window.innerWidth <= 1023) {
                    numColumns = 2; // Tablet
                }
                
                const columns = [];
                for (let i = 0; i < numColumns; i++) {
                    columns[i] = [];
                }
                
                // Distribuir competencias en columnas para lectura de izquierda a derecha y arriba hacia abajo
                competenciasOrdenadas.forEach((competencia, index) => {
                    const columnIndex = index % numColumns;
                    columns[columnIndex].push(competencia);
                });

                competenciasHtml += `
                    <div class="academia-competencias-container" data-academia="${academia.nombre}">
                        <div class="competencias-grid-v1">
                            ${columns.map(column => `
                                <div class="competencias-column">
                                    ${column.map(competencia => {
                                        const imageName = competenciaImageMap[competencia.nombre] || 'Accountability.jpg';
                                        const imagePath = `images/imagenes competencias/${imageName}`;
                                        const isAssigned = competenciasAsignadas.includes(competencia.nombre);
                                        return `
                                            <div class="competencia-card-v1-wrapper">
                                                <div class="competencia-card-v1 ${isAssigned ? 'is-assigned' : ''}" data-competencia="${competencia.nombre}" data-academia="${academia.nombre}">
                                                    <img src="${imagePath}" alt="${competencia.nombre}" class="competencia-card-v1-image" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=400&h=300&fit=crop'">
                                                    <div class="competencia-card-v1-content">
                                                        <div class="competencia-card-v1-title-wrapper">
                                                            <p class="ubits-body-sm-semibold competencia-card-v1-title">
                                                                <span class="competencia-card-v1-title-text">${competencia.nombre}</span>
                                                                ${isAssigned ? '<span class="ubits-status-tag ubits-status-tag--info ubits-status-tag--xs"><span class="ubits-status-tag__text">Asignado</span></span>' : ''}
                                                            </p>
                                                        </div>
                                                        <p class="ubits-body-xs-regular competencia-card-v1-count">${competencia.habilidades.length} habilidades</p>
                                                    </div>
                                                    <div class="competencia-card-v1-actions">
                                                        <button class="ubits-button ubits-button--tertiary ubits-button--xs ubits-button--icon-only" aria-label="Filtrar por esta competencia" data-tooltip="Filtrar por esta competencia">
                                                            <i class="far fa-filter"></i>
                                                        </button>
                                                        <button class="ubits-button ubits-button--tertiary ubits-button--xs ubits-button--icon-only competencia-card-v1-chevron-btn" aria-label="Ver habilidades" data-competencia="${competencia.nombre}" data-academia="${academia.nombre}" data-tooltip="Ver habilidades">
                                                            <i class="far fa-chevron-down competencia-card-v1-chevron"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="competencia-habilidades-container" data-competencia="${competencia.nombre}" data-academia="${academia.nombre}">
                                                    <div class="competencias-habilidades-grid">
                                                        ${competencia.habilidades.sort((a, b) => a.localeCompare(b, 'es', { sensitivity: 'base' })).map(habilidad => {
                                                            const icon = habilidadIconMap[habilidad] || 'fa-circle';
                                                            return `
                                                                <div class="habilidad-chip">
                                                                    <i class="far ${icon}"></i>
                                                                    <span class="ubits-body-sm-regular">${habilidad}</span>
                                                                </div>
                                                            `;
                                                        }).join('')}
                                                    </div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            });

            resultsContainer.innerHTML = academiasHtml + competenciasHtml;

            // Asegurar que los event listeners est√©n adjuntos (solo una vez)
            attachCatalogEventListeners();
            
            document.querySelectorAll('.competencia-card-v1-actions .ubits-button').forEach(button => {
                button.addEventListener('mouseenter', function() {
                    const tooltipText = this.getAttribute('data-tooltip');
                    if (!tooltipText) return;
                    
                    // Crear tooltip temporal para calcular dimensiones
                    const tempTooltip = document.createElement('div');
                    tempTooltip.textContent = tooltipText;
                    tempTooltip.style.cssText = 'position: absolute; visibility: hidden; white-space: nowrap; padding: 6px 10px; font-size: var(--font-size-sm); font-family: "Noto Sans", sans-serif;';
                    document.body.appendChild(tempTooltip);
                    const tooltipWidth = tempTooltip.offsetWidth;
                    const tooltipHeight = tempTooltip.offsetHeight;
                    document.body.removeChild(tempTooltip);
                    
                    const rect = this.getBoundingClientRect();
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    const margin = 10;
                    
                    // Determinar posici√≥n
                    const spaceAbove = rect.top;
                    const spaceBelow = viewportHeight - rect.bottom;
                    const spaceRight = viewportWidth - rect.right;
                    const spaceLeft = rect.left;
                    
                    // Resetear clases
                    this.classList.remove('tooltip-top', 'tooltip-bottom', 'tooltip-left', 'tooltip-right');
                    
                    // Determinar posici√≥n vertical
                    const useBottom = spaceAbove < tooltipHeight + margin;
                    
                    // Determinar posici√≥n horizontal
                    let horizontalPos = 'center';
                    if (spaceRight < tooltipWidth / 2 + margin) {
                        horizontalPos = 'right';
                    } else if (spaceLeft < tooltipWidth / 2 + margin) {
                        horizontalPos = 'left';
                    }
                    
                    // Aplicar clases
                    if (useBottom) {
                        this.classList.add('tooltip-bottom');
                    }
                    if (horizontalPos === 'right') {
                        this.classList.add('tooltip-right');
                    } else if (horizontalPos === 'left') {
                        this.classList.add('tooltip-left');
                    }
                });
            });

        }

    </script>
</body>
</html>

